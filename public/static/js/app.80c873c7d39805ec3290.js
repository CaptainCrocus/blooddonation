webpackJsonp([1],{"1/oy":function(e,t){},ARhe:function(e,t){},Id91:function(e,t){},Mhaf:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("7+uW"),s=r("e6fC"),o={name:"App",methods:{logout:function(){window.location=window.location.origin+"/signout"}}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-fluid"},[r("b-navbar",{attrs:{type:"dark",variant:"info",toggleable:"md"}},[r("b-navbar-toggle",{attrs:{target:"nav_dropdown_collapse"}}),e._v(" "),r("b-navbar-brand",{attrs:{href:"#"}},[e._v("BloodTrans")]),e._v(" "),r("b-collapse",{attrs:{"is-nav":"",id:"nav_dropdown_collapse"}},[r("b-navbar-nav",[r("b-nav-item-dropdown",{attrs:{text:"Персоны"}},[r("b-dropdown-item",{attrs:{to:{name:"Persons"},href:"#"}},[e._v("Список персон")]),e._v(" "),r("b-dropdown-item",{attrs:{to:{name:"PersonAdd"}}},[e._v("Добавить персону")])],1),e._v(" "),r("b-nav-item-dropdown",{attrs:{text:"Заборы крови"}},[r("b-dropdown-item",{attrs:{to:{name:"Draws"}}},[e._v("Список заборов")]),e._v(" "),r("b-dropdown-item",{attrs:{to:{name:"DrawAdd"}}},[e._v("Произвести забор")])],1),e._v(" "),r("b-nav-item-dropdown",{attrs:{text:"Переливания"}},[r("b-dropdown-item",{attrs:{to:{name:"Trans"}}},[e._v("Список переливаний")]),e._v(" "),r("b-dropdown-item",{attrs:{to:{name:"TransAdd"}}},[e._v("Сделать переливание")])],1)],1),e._v(" "),r("b-navbar-nav",{staticClass:"ml-auto"},[r("b-nav-item",{attrs:{right:""},on:{click:e.logout}},[e._v("Выйти")])],1)],1)],1),e._v(" "),r("div",{attrs:{id:"app"}},[r("router-view")],1)],1)},staticRenderFns:[]};var i=r("VU/8")(o,n,!1,function(e){r("wGKJ")},null,null).exports,l=r("/ocq"),c={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hello"},[t("h1",[this._v(this._s(this.msg))])])},staticRenderFns:[]};var d=r("VU/8")({name:"HelloWorld",data:function(){return{msg:"Welcome to Blood Transfusion DataBase"}}},c,!1,function(e){r("ARhe")},"data-v-4009cf63",null).exports,p=r("Xxa5"),m=r.n(p),u=r("exGp"),b=r.n(u),v=r("//Fk"),f=r.n(v),_=r("mtWM"),h=r.n(_),w=function(){var e=h.a.create({baseURL:"http://localhost:5000",withCredentials:!0});return e.interceptors.response.use(function(e){return void 0===e.data.success||e.data.success||void 0===e.data.redirect||(window.location=window.location.origin+e.data.redirect),e},function(e){return f.a.reject(e)}),e},y=function(e){return w().get("api/person",{params:e})},x=function(e){return w().post("api/person",e)},k=function(e){return w().get("api/person/"+e.id)},g=function(e){return w().put("api/person/"+e.id,e)},N=function(){return w().get("api/bloodtype")},T={name:"Persons",data:function(){return{sex:[{value:null,text:"Любого пола"},{value:"male",text:"мужчины"},{value:"female",text:"женщины"}],currentPage:1,persons:[],bloodTypes:[],searchObject:{name:"",fin:"",sex:null,bloodType:null,pageSize:10,totalCount:0,offset:0,sortObj:{}}}},props:["mode"],computed:{fields:function(){var e=[{key:"index",label:"#"},{key:"fullName",label:"Имя",sortable:!0}];return void 0===this.mode&&(e.push({key:"bloodType",label:"Группа крови",sortable:!0}),e.push({key:"fin",label:"FIN"})),e.push({key:"actions",label:"Action"}),e}},methods:{getPersons:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y(e.searchObject);case 2:(r=t.sent).data.success&&(e.persons=r.data.data.map(function(t,r,a){return t.fullName=e.$tools.smartJoin([t.firstName,t.lastName,t.middleName]),t.index=r+e.searchObject.offset,t}),e.searchObject.totalCount=r.data.totalCount),5;case 5:case"end":return t.stop()}},t,e)}))()},getBloodTypes:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:(r=t.sent).data.success&&(e.bloodTypes=r.data.data,e.bloodTypes.push({_id:null,typeName:"Все группы крови"}));case 4:case"end":return t.stop()}},t,e)}))()},selectPerson:function(e){this.$emit("selectperson",e)},goToPage:function(e){this.searchObject.offset=(e-1)*this.searchObject.pageSize,this.getPersons()},searchPerson:function(){var e=this;return b()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.searchObject.offset=0,t.next=3,e.getPersons();case 3:e.currentPage=Math.ceil(e.searchObject.offset/e.searchObject.pageSize);case 4:case"end":return t.stop()}},t,e)}))()},sortingChanged:function(e){this.searchObject.sortObj[e.sortBy]=e.sortDesc,this.getPersons()}},created:function(){this.getBloodTypes()},mounted:function(){this.getPersons()}},C={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("h1",{staticClass:"mb-4"},[e._v("Список персон")]),e._v(" "),r("b-row",{staticClass:"mb-4"},[r("b-col",{attrs:{cols:"12"}},[r("b-form",{attrs:{inline:""},on:{submit:function(t){t.preventDefault(),e.searchPerson(t)}}},[r("label",{staticClass:"sr-only",attrs:{for:"name"}},[e._v("Имя или фамилия")]),e._v(" "),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"name",name:"name",placeHolder:"имя"},model:{value:e.searchObject.name,callback:function(t){e.$set(e.searchObject,"name",t)},expression:"searchObject.name"}}),e._v(" "),r("label",{staticClass:"sr-only",attrs:{for:"fin"}},[e._v("FIN")]),e._v(" "),r("b-input",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"fin",name:"fin",placeHolder:"FIN"},model:{value:e.searchObject.fin,callback:function(t){e.$set(e.searchObject,"fin",t)},expression:"searchObject.fin"}}),e._v(" "),r("label",{staticClass:"sr-only",attrs:{for:"bloodType"}},[e._v("Группа крови")]),e._v(" "),r("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"bloodType","value-field":"_id","text-field":"typeName",options:e.bloodTypes,name:"bloodType"},model:{value:e.searchObject.bloodType,callback:function(t){e.$set(e.searchObject,"bloodType",t)},expression:"searchObject.bloodType"}}),e._v(" "),r("label",{staticClass:"sr-only",attrs:{for:"sex"}},[e._v("Пол")]),e._v(" "),r("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"sex",options:e.sex,name:"sex"},model:{value:e.searchObject.sex,callback:function(t){e.$set(e.searchObject,"sex",t)},expression:"searchObject.sex"}}),e._v(" "),r("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Найти")])],1)],1)],1),e._v(" "),r("b-table",{attrs:{striped:"",small:"",hover:"","no-provider-paging":"","no-provider-sorting":"","no-provider-filtering":"","no-local-sorting":"",stacked:"sm",items:e.persons,fields:e.fields},on:{"sort-changed":e.sortingChanged},scopedSlots:e._u([{key:"index",fn:function(t){return[e._v("\n      \t"+e._s(t.value+1)+"\n      ")]}},{key:"bloodType",fn:function(t){return[e._v("\n        "+e._s(t.value.typeName)+"\n      ")]}},{key:"donor",fn:function(t){return[e._v("\n        "+e._s(t.item.donor)+" / "+e._s(t.item.recipient)+"\n      ")]}},{key:"actions",fn:function(t){return[r("b-form-checkbox",{on:{change:t.toggleDetails},nativeOn:{click:function(e){e.stopPropagation()}},model:{value:t.detailsShowing,callback:function(r){e.$set(t,"detailsShowing",r)},expression:"row.detailsShowing"}},[e._v("Инфо")]),e._v(" "),e.mode?e._e():r("b-btn",{attrs:{size:"sm",to:{name:"PersonShow",params:{id:t.item._id}},variant:"light"}},[e._v("просмотреть")]),e._v(" "),e.mode?e._e():r("b-btn",{attrs:{size:"sm",to:{name:"DrawAdd",params:{id:t.item._id}},variant:"light"}},[r("div",{staticClass:"blood-transfusion",attrs:{title:"забор"}})]),e._v(" "),"personselect"===e.mode?r("b-btn",{attrs:{size:"sm"},on:{click:function(r){e.selectPerson(t.item)}}},[e._v("выбрать")]):e._e()]}},{key:"row-details",fn:function(t){return[r("b-card",[t.item.sex?r("b-row",{staticClass:"mb-2"},[r("b-col",{staticClass:"text-sm-right",attrs:{sm:"4"}},[r("b",[e._v("Пол:")])]),e._v(" "),r("b-col",[e._v(e._s("male"==t.item.sex?"мужской":"женский"))])],1):e._e(),e._v(" "),t.item.donor||t.item.recipient?r("b-row",{staticClass:"mb-2"},[r("b-col",{staticClass:"text-sm-right",attrs:{sm:"4"}},[r("b",[e._v("Статус:")])]),e._v(" "),r("b-col",[t.item.donor?r("span",[e._v("донор ")]):e._e(),t.item.recipient?r("span",[t.item.donor?r("span",[e._v("| ")]):e._e(),e._v("реципиент ")]):e._e()])],1):e._e(),e._v(" "),t.item.phone?r("b-row",{staticClass:"mb-2"},[r("b-col",{staticClass:"text-sm-right",attrs:{sm:"4"}},[r("b",[e._v("Телефон:")])]),e._v(" "),r("b-col",[e._v(e._s(t.item.phone))])],1):e._e(),e._v(" "),t.item.mobile?r("b-row",{staticClass:"mb-2"},[r("b-col",{staticClass:"text-sm-right",attrs:{sm:"4"}},[r("b",[e._v("Мобильный:")])]),e._v(" "),r("b-col",[e._v(e._s(t.item.mobile))])],1):e._e(),e._v(" "),t.item.address?r("b-row",{staticClass:"mb-2"},[r("b-col",{staticClass:"text-sm-right",attrs:{sm:"4"}},[r("b",[e._v("Адрес:")])]),e._v(" "),r("b-col",[e._v(e._s(t.item.address))])],1):e._e(),e._v(" "),t.item.description?r("b-row",{staticClass:"mb-2"},[r("b-col",{staticClass:"text-sm-right",attrs:{sm:"4"}},[r("b",[e._v("Доп. информация:")])]),e._v(" "),r("b-col",[e._v(e._s(t.item.description))])],1):e._e(),e._v(" "),r("b-button",{attrs:{size:"sm"},on:{click:t.toggleDetails}},[e._v("Скрыть")])],1)]}}])}),e._v(" "),r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("b-pagination",{attrs:{"total-rows":e.searchObject.totalCount,"per-page":e.searchObject.pageSize},on:{change:e.goToPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)],1)],1)],1)},staticRenderFns:[]};var P=r("VU/8")(T,C,!1,function(e){r("Mhaf")},null,null).exports,z={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("b-alert",{attrs:{dismissible:"",show:0!==e.errors.length,variant:"danger"},on:{dismissed:e.closeBoard}},[r("b-col",{attrs:{cols:"10"}},[r("h5",[e._v("Errors: ")]),e._v(" "),e._l(e.errors,function(t){return r("p",[e._v("\n\t\t\t\t\t"+e._s(t.message)+"\n\t\t\t\t")])})],2)],1)],1)],1)},staticRenderFns:[]},D=r("VU/8")({name:"ErrorBoard",data:function(){return{}},props:["errors"],methods:{closeBoard:function(){this.$emit("clearerrors")}}},z,!1,null,null,null).exports,$={name:"PersonAdd",data:function(){return{firstName:"",lastName:"",middleName:"",passport:"",fin:"",address:"",phone:"",mobile:"",sex:"male",bloodType:1,description:"",bloodTypes:[],errors:[]}},methods:{addPerson:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.fin&&e.firstName&&e.sex&&e.bloodType&&7==e.fin.length){t.next=2;break}return t.abrupt("return",e.errors.push({message:"Заполните правильно все обязательные поля"}));case 2:return t.prev=2,t.next=5,x({firstName:e.firstName,lastName:e.lastName,middleName:e.middleName,passport:e.passport,fin:e.fin,address:e.address,phone:e.phone,mobile:e.mobile,sex:e.sex,bloodType:e.bloodType,description:e.description});case 5:void 0===(r=t.sent).data.success||r.data.success?e.$router.push({name:"PersonShow",params:{id:r.data.data._id}}):r.data.errors&&r.data.errors.forEach(function(t,r,a){e.errors.push(t)}),t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(2),t.t0.response){t.next=13;break}return t.abrupt("return",e.errors.push({message:"Отсутствует соединение с сервером"}));case 13:e.errors.push({message:t.t0.response.data.errors});case 14:case"end":return t.stop()}},t,e,[[2,9]])}))()},getBloodTypes:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:r=t.sent,e.bloodTypes=r.data.data;case 4:case"end":return t.stop()}},t,e)}))()},clearErrors:function(){this.errors=[]}},created:function(){this.getBloodTypes()}},S={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("h1",[e._v("Добавление персоны")]),e._v(" "),r("error-board",{attrs:{errors:e.errors},on:{clearerrors:e.clearErrors}}),e._v(" "),r("b-form",{attrs:{method:"POST"},on:{submit:function(t){t.preventDefault(),e.addPerson(t)}}},[r("b-row",[r("b-col",{attrs:{cols:"6"}},[r("b-form-group",{attrs:{horizontal:"",label:"Имя","label-cols":3,breakpoints:"md","label-for":"firstName"}},[r("b-form-input",{attrs:{type:"text","aria-describedby":"firstNameLiveFeedback",state:e.firstName.length>1,id:"firstName",name:"firstName"},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),e._v(" "),r("b-form-invalid-feedback",{attrs:{id:"firstNameLiveFeedback"}},[e._v("\n\t\t\t\t\t\t      Введите не меньше 2 букв\n    \t\t\t\t\t\t")])],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Фамилия","label-cols":3,breakpoints:"md","label-for":"lastName"}},[r("b-form-input",{attrs:{type:"text",id:"lastName",name:"lastName"},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Отчество","label-cols":3,breakpoints:"md","label-for":"middleName"}},[r("b-form-input",{staticClass:"form-control",attrs:{type:"text",id:"middleName",name:"middleName"},model:{value:e.middleName,callback:function(t){e.middleName=t},expression:"middleName"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Удостовение личности","label-cols":6,breakpoints:"md","label-for":"passport"}},[r("b-form-input",{attrs:{type:"text",id:"passport",name:"passport"},model:{value:e.passport,callback:function(t){e.passport=t},expression:"passport"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"FIN-код","label-cols":3,breakpoints:"md","label-for":"fin"}},[r("b-form-input",{attrs:{type:"text",id:"fin",name:"fin",state:7==e.fin.length,formatter:function(e){return e.toUpperCase()},"aria-describedby":"finLiveFeedback"},model:{value:e.fin,callback:function(t){e.fin=t},expression:"fin"}}),e._v(" "),r("b-form-invalid-feedback",{attrs:{id:"finLiveFeedback"}},[e._v("\n\t\t\t\t\t\t      FIN содержит 7 символов\n    \t\t\t\t\t\t")])],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Адрес","label-cols":3,breakpoints:"md","label-for":"address"}},[r("b-form-input",{attrs:{type:"text",id:"address",name:"address"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1)],1),e._v(" "),r("b-col",{attrs:{cols:"6"}},[r("b-form-group",{attrs:{horizontal:"",label:"Телефон","label-cols":3,breakpoints:"md","label-for":"phone"}},[r("b-form-input",{attrs:{type:"text",id:"phone",name:"phone"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Моб. телефон","label-cols":3,breakpoints:"md","label-for":"mobile"}},[r("b-form-input",{attrs:{type:"text",id:"mobile",name:"mobile"},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Группа крови","label-cols":3,breakpoints:"md","label-for":"bloodType"}},[r("b-form-select",{attrs:{id:"bloodType","value-field":"_id","text-field":"typeName",options:e.bloodTypes,name:"bloodType"},model:{value:e.bloodType,callback:function(t){e.bloodType=t},expression:"bloodType"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Пол","label-cols":3,breakpoints:"md","label-for":"sex"}},[r("b-form-select",{attrs:{id:"sex",name:"sex"},model:{value:e.sex,callback:function(t){e.sex=t},expression:"sex"}},[r("option",{attrs:{selected:"",value:"male"}},[e._v("мужской")]),e._v(" "),r("option",{attrs:{value:"female"}},[e._v("женский")])])],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Доп. информация","label-cols":4,breakpoints:"md","label-for":"description"}},[r("b-form-textarea",{attrs:{id:"description",name:"description",rows:"4"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1)],1),e._v(" "),r("b-col",{attrs:{cols:"6"}},[r("b-btn",{attrs:{type:"submit",variant:"primary"}},[e._v("Создать")])],1)],1)],1)],1)],1)},staticRenderFns:[]},F=r("VU/8")($,S,!1,null,null,null).exports,O={name:"PersonShow",data:function(){return{person:{}}},methods:{getPerson:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k({id:e.$route.params.id});case 2:!1!==(r=t.sent).data.success&&(e.person=r.data.data);case 4:case"end":return t.stop()}},t,e)}))()}},created:function(){},mounted:function(){this.getPerson()}},j={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("div",{staticClass:"card"},[r("h5",{staticClass:"card-header"},[e.person.firstName?r("span",[e._v(e._s(e.person.firstName)+" "+e._s(e.person.lastName)+", "+e._s(e.person.middleName))]):e._e()]),e._v(" "),r("div",{staticClass:"card-body"},[e.person.bloodType?r("p",[r("b",[e._v("Группа крови:")]),e._v(" "+e._s(e.person.bloodType.typeName))]):e._e(),e._v(" "),e.person.sex?r("p",[r("b",[e._v("Пол:")]),e._v(" "+e._s("male"==e.person.sex?"мужской":"женский"))]):e._e(),e._v(" "),e.person.address?r("p",[r("b",[e._v("Адрес:")]),e._v(" "+e._s(e.person.address))]):e._e(),e._v(" "),e.person.phone?r("p",[r("b",[e._v("Телефон:")]),e._v(" "+e._s(e.person.phone))]):e._e(),e._v(" "),e.person.mobile?r("p",[r("b",[e._v("Мобильный:")]),e._v(" "+e._s(e.person.mobile))]):e._e(),e._v(" "),e.person.passport?r("p",[r("b",[e._v("Удостоверение:")]),e._v(" "+e._s(e.person.passport))]):e._e(),e._v(" "),e.person.fin?r("p",[r("b",[e._v("FIN:")]),e._v(" "+e._s(e.person.fin))]):e._e(),e._v(" "),e.person.mobile?r("p",[r("b",[e._v("Мобильный:")]),e._v(" "+e._s(e.person.mobile))]):e._e(),e._v(" "),e.person.description?r("p",[r("b",[e._v("Доп. информация:")]),e._v(" "+e._s(e.person.description))]):e._e(),e._v(" "),e.person.donor?r("p",[r("b",[e._v("Донор")])]):e._e(),e._v(" "),e.person.recipient?r("p",[r("b",[e._v("Реципиент")])]):e._e(),e._v(" "),r("b-button",{attrs:{to:{name:"DrawAdd",params:{id:e.person._id}},variant:"primary"}},[e._v("Сделать забор")]),e._v(" "),r("b-button",{attrs:{to:{name:"PersonAdd"},variant:"primary"}},[e._v("Создать новую персону")]),e._v(" "),r("b-button",{attrs:{to:{name:"Persons"},variant:"primary"}},[e._v("Список персон")])],1)])])],1)},staticRenderFns:[]};var E=r("VU/8")(O,j,!1,function(e){r("yiZ2")},null,null).exports,A={name:"PersonEdit",data:function(){return{person:{},bloodTypes:[],errors:[]}},methods:{updatePerson:function(){var e=this;return b()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g({id:e.person._id,firstName:e.person.firstName,lastName:e.person.lastName,middleName:e.person.middleName,passport:e.person.passport,fin:e.person.fin,address:e.person.address,phone:e.person.phone,mobile:e.person.mobile,sex:e.person.sex,bloodType:e.person.bloodType,description:e.person.description});case 2:alert("Person updated");case 3:case"end":return t.stop()}},t,e)}))()},getPerson:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k({id:e.$route.params.id});case 2:r=t.sent,e.person=r.data.data;case 4:case"end":return t.stop()}},t,e)}))()},getBloodTypes:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:r=t.sent,e.bloodTypes=r.data.data;case 4:case"end":return t.stop()}},t,e)}))()},clearErrors:function(){this.errors=[]}},created:function(){this.getBloodTypes()},mounted:function(){this.getPerson()}},M={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("h1",[e._v("Редактирование персоны")]),e._v(" "),r("error-board",{attrs:{errors:e.errors},on:{clearerrors:e.clearErrors}}),e._v(" "),r("b-form",{attrs:{method:"POST"},on:{submit:function(t){t.preventDefault(),e.addPerson(t)}}},[r("b-row",[r("b-col",{attrs:{cols:"6"}},[r("b-form-group",{attrs:{horizontal:"",label:"Имя","label-cols":3,breakpoints:"md","label-for":"firstName"}},[r("b-form-input",{attrs:{type:"text","aria-describedby":"firstNameLiveFeedback",state:e.firstName.length>1,id:"firstName",name:"firstName"},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),e._v(" "),r("b-form-invalid-feedback",{attrs:{id:"firstNameLiveFeedback"}},[e._v("\n\t\t\t\t\t\t      Введите не меньше 2 букв\n    \t\t\t\t\t\t")])],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Фамилия","label-cols":3,breakpoints:"md","label-for":"lastName"}},[r("b-form-input",{attrs:{type:"text",id:"lastName",name:"lastName"},model:{value:e.lastName,callback:function(t){e.lastName=t},expression:"lastName"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Отчество","label-cols":3,breakpoints:"md","label-for":"middleName"}},[r("b-form-input",{staticClass:"form-control",attrs:{type:"text",id:"middleName",name:"middleName"},model:{value:e.middleName,callback:function(t){e.middleName=t},expression:"middleName"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Удостовение личности","label-cols":6,breakpoints:"md","label-for":"passport"}},[r("b-form-input",{attrs:{type:"text",id:"passport",name:"passport"},model:{value:e.passport,callback:function(t){e.passport=t},expression:"passport"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"FIN-код","label-cols":3,breakpoints:"md","label-for":"fin"}},[r("b-form-input",{attrs:{type:"text",id:"fin",name:"fin",state:7==e.fin.length,formatter:function(e){return e.toUpperCase()},"aria-describedby":"finLiveFeedback"},model:{value:e.fin,callback:function(t){e.fin=t},expression:"fin"}}),e._v(" "),r("b-form-invalid-feedback",{attrs:{id:"finLiveFeedback"}},[e._v("\n\t\t\t\t\t\t      FIN содержит 7 символов\n    \t\t\t\t\t\t")])],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Адрес","label-cols":3,breakpoints:"md","label-for":"address"}},[r("b-form-input",{attrs:{type:"text",id:"address",name:"address"},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}})],1)],1),e._v(" "),r("b-col",{attrs:{cols:"6"}},[r("b-form-group",{attrs:{horizontal:"",label:"Телефон","label-cols":3,breakpoints:"md","label-for":"phone"}},[r("b-form-input",{attrs:{type:"text",id:"phone",name:"phone"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Моб. телефон","label-cols":3,breakpoints:"md","label-for":"mobile"}},[r("b-form-input",{attrs:{type:"text",id:"mobile",name:"mobile"},model:{value:e.mobile,callback:function(t){e.mobile=t},expression:"mobile"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Группа крови","label-cols":3,breakpoints:"md","label-for":"bloodType"}},[r("b-form-select",{attrs:{id:"bloodType","value-field":"_id","text-field":"typeName",options:e.bloodTypes,name:"bloodType"},model:{value:e.bloodType,callback:function(t){e.bloodType=t},expression:"bloodType"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Пол","label-cols":3,breakpoints:"md","label-for":"sex"}},[r("b-form-select",{attrs:{id:"sex",name:"sex"},model:{value:e.sex,callback:function(t){e.sex=t},expression:"sex"}},[r("option",{attrs:{selected:"",value:"male"}},[e._v("мужской")]),e._v(" "),r("option",{attrs:{value:"female"}},[e._v("женский")])])],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Доп. информация","label-cols":4,breakpoints:"md","label-for":"description"}},[r("b-form-textarea",{attrs:{id:"description",name:"description",rows:"4"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1)],1),e._v(" "),r("b-col",{attrs:{cols:"6"}},[r("b-btn",{attrs:{type:"submit",variant:"primary"}},[e._v("Создать")])],1)],1)],1)],1)],1)},staticRenderFns:[]},R=r("VU/8")(A,M,!1,null,null,null).exports,B=function(){return w().get("api/draw")},U=function(e){return w().post("api/draw",e)},V=function(e){return w().get("api/draw/"+e.id)},I={name:"Persons",data:function(){return{fields:[{key:"index",label:"#"},{key:"date",label:"Дата"},{key:"source",label:"Материал"},{key:"volume",label:"Объем"},{key:"remainder",label:"Остаток"},{key:"bloodType",label:"Группа крови"},{key:"person",label:"Донор"},{key:"actions",label:"Action"}],draws:[],bloodTypes:[]}},props:["mode"],methods:{getDraws:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B();case 2:r=t.sent,e.draws=r.data.data.map(function(t){return t.person.fullName=e.$tools.smartJoin([t.person.firstName,t.person.lastName]),t});case 4:case"end":return t.stop()}},t,e)}))()},getBloodTypes:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:r=t.sent,e.bloodTypes=r.data.data;case 4:case"end":return t.stop()}},t,e)}))()},selectDraw:function(e){this.$emit("selectdraw",e)}},created:function(){this.getDraws(),this.getBloodTypes()}},J={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("h1",[e._v("Заборы крови")]),e._v(" "),r("b-table",{attrs:{striped:"",stacked:"md",small:"",hover:"",items:e.draws,fields:e.fields},scopedSlots:e._u([{key:"index",fn:function(t){return[e._v("\n        "+e._s(t.index+1)+"\n      ")]}},{key:"source",fn:function(t){return[e._v("\n        "+e._s(t.value.sourceName)+" ("+e._s(t.value.measure)+")\n      ")]}},{key:"bloodType",fn:function(t){return[e._v("\n        "+e._s(t.value.typeName)+"\n      ")]}},{key:"person",fn:function(t){return[e._v("\n        "+e._s(t.value.fullName)+"\n      ")]}},{key:"actions",fn:function(t){return["drawselect"!==e.mode?r("b-btn",{attrs:{size:"sm",to:{name:"DrawShow",params:{id:t.item._id}}}},[e._v("просм.")]):e._e(),e._v(" "),"drawselect"!==e.mode?r("b-btn",{attrs:{size:"sm",to:{name:"TransAdd",params:{id:t.item._id}}}},[e._v("перелив.")]):e._e(),e._v(" "),"drawselect"===e.mode?r("b-btn",{attrs:{size:"sm"},on:{click:function(r){e.selectDraw(t.item)}}},[e._v("выбрать")]):e._e()]}}])})],1)],1)},staticRenderFns:[]},L=r("VU/8")(I,J,!1,null,null,null).exports,H=function(){return w().get("api/source")},W={name:"DrawAdd",data:function(){return{volume:null,source:null,description:"",date:this.$tools.formatDate(new Date),time:this.$tools.formatTime(new Date),person:{},bloodTypes:[],sources:[],errors:[]}},components:{"person-window":P},computed:{fullName:function(){return this.$tools.smartJoin([this.person.firstName,this.person.lastName,this.person.middleName])}},methods:{addDraw:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.volume&&e.source&&e.person._id&&e.person.bloodType._id&&e.date){t.next=2;break}return t.abrupt("return",e.errors.push({message:"Заполните правильно все обязательные поля"}));case 2:return t.prev=2,t.next=5,U({volume:e.volume,source:e.source,person:e.person._id,bloodType:e.person.bloodType._id,date:e.date+" "+e.time,description:e.description});case 5:void 0===(r=t.sent).data.success||r.data.success?e.$router.push({name:"DrawShow",params:{id:r.data.data._id}}):r.data.errors&&r.data.errors.forEach(function(t,r,a){e.errors.push(t)}),t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(2),t.t0.response){t.next=13;break}return t.abrupt("return",e.errors.push({message:"Отсутствует соединение с сервером"}));case 13:e.errors.push({message:t.t0.response.data.errors});case 14:case"end":return t.stop()}},t,e,[[2,9]])}))()},getPerson:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k({id:e.$route.params.id});case 2:!1!==(r=t.sent).data.success&&(e.person=r.data.data);case 4:case"end":return t.stop()}},t,e)}))()},getSources:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H();case 2:!1!==(r=t.sent).data.success&&(e.sources=r.data.data);case 4:case"end":return t.stop()}},t,e)}))()},setDonor:function(e){this.person=e,this.$refs.donModal.hide()},clearErrors:function(){this.errors=[]}},created:function(){var e=b()(m.a.mark(function e(){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSources();case 2:this.getPerson();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},G={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",[r("h1",[e._v("Забор крови")]),e._v(" "),r("error-board",{attrs:{errors:e.errors},on:{clearerrors:e.clearErrors}}),e._v(" "),r("b-row",[r("b-col",{attrs:{sm:"6"}},[r("div",{staticClass:"card"},[r("h5",{staticClass:"card-header"},[r("b",[e._v("Донор: ")]),e.person.firstName?r("span",[e._v(e._s(e.fullName))]):e._e()]),e._v(" "),r("div",{staticClass:"card-body"},[e.person.bloodType?r("p",[r("b",[e._v("Группа крови:")]),e._v(" "+e._s(e.person.bloodType.typeName))]):e._e(),e._v(" "),e.person.sex?r("p",[r("b",[e._v("Пол:")]),e._v(" "+e._s("male"==e.person.sex?"мужской":"женский"))]):e._e(),e._v(" "),e.person.address?r("p",[r("b",[e._v("Адрес:")]),e._v(" "+e._s(e.person.address))]):e._e(),e._v(" "),e.person.phone?r("p",[r("b",[e._v("Телефон:")]),e._v(" "+e._s(e.person.phone))]):e._e(),e._v(" "),e.person.mobile?r("p",[r("b",[e._v("Мобильный:")]),e._v(" "+e._s(e.person.mobile))]):e._e(),e._v(" "),e.person.passport?r("p",[r("b",[e._v("Удостоверение:")]),e._v(" "+e._s(e.person.passport))]):e._e(),e._v(" "),e.person.fin?r("p",[r("b",[e._v("FIN:")]),e._v(" "+e._s(e.person.fin))]):e._e(),e._v(" "),e.person.mobile?r("p",[r("b",[e._v("Мобильный:")]),e._v(" "+e._s(e.person.mobile))]):e._e(),e._v(" "),e.person.description?r("p",[r("b",[e._v("Доп. информация:")]),e._v(" "+e._s(e.person.description))]):e._e(),e._v(" "),e.person.donor?r("p",[r("b",[e._v("Донор")])]):e._e(),e._v(" "),e.person.recipient?r("p",[r("b",[e._v("Реципиент")])]):e._e(),e._v(" "),r("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.donModal",modifiers:{donModal:!0}}]},[e._v("Выбрать донора")]),e._v(" "),r("b-modal",{ref:"donModal",attrs:{id:"donModal",title:"Выбор донора","ok-only":"","ok-title":"Отменить"}},[r("person-window",{attrs:{mode:"personselect"},on:{selectperson:e.setDonor}})],1)],1)])]),e._v(" "),r("b-col",{attrs:{sm:"6"}},[r("b-form",{attrs:{action:"/api/person/add",method:"POST"}},[r("b-form-group",{attrs:{horizontal:"",label:"Материал","label-cols":3,breakpoints:"md","label-for":"source"}},[r("b-form-select",{attrs:{id:"source","value-field":"_id","text-field":"sourceName",options:e.sources,name:"source"},model:{value:e.source,callback:function(t){e.source=t},expression:"source"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Количество","label-cols":3,breakpoints:"md","label-for":"volume"}},[r("b-form-input",{staticClass:"form-control",attrs:{type:"text",id:"volume",name:"volume"},model:{value:e.volume,callback:function(t){e.volume=t},expression:"volume"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Дата","label-cols":3,breakpoints:"md","label-for":"date"}},[r("b-form-input",{staticClass:"form-control",attrs:{type:"text",id:"date",name:"date"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Время","label-cols":3,breakpoints:"md","label-for":"time"}},[r("b-form-input",{staticClass:"form-control",attrs:{type:"text",id:"time",name:"date"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Доп. информация","label-cols":3,breakpoints:"md","label-for":"description"}},[r("b-form-textarea",{staticClass:"form-control",attrs:{id:"description",name:"description",rows:"3"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1)],1)],1),e._v(" "),r("p",[e._v("-")]),e._v(" "),r("b-col",{attrs:{sm:"12"}},[r("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:e.addDraw}},[e._v("Произвести забор")])])],1)],1)},staticRenderFns:[]},Q=r("VU/8")(W,G,!1,null,null,null).exports,X={name:"DrawShow",data:function(){return{draw:{}}},methods:{getDraw:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V({id:e.$route.params.id});case 2:!1!==(r=t.sent).data.success&&(e.draw=r.data.data);case 4:case"end":return t.stop()}},t,e)}))()}},created:function(){},mounted:function(){this.getDraw()}},K={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-container",[r("h1",[e._v("Информация о заборе")])]),e._v(" "),r("b-col",{attrs:{cols:"12"}},[r("div",{staticClass:"card"},[r("h5",{staticClass:"card-header"},[r("b",[e._v("Группа крови: ")]),e.draw.bloodType?r("span",[e._v(e._s(e.draw.bloodType.typeName))]):e._e()]),e._v(" "),r("div",{staticClass:"card-body"},[e.draw.source?r("p",[r("b",[e._v("Материал:")]),e._v(" "+e._s(e.draw.source.sourceName)+" ("+e._s(e.draw.source.measure)+")")]):e._e(),e._v(" "),e.draw.volume?r("p",[r("b",[e._v("Объем:")]),e._v(" "+e._s(e.draw.volume))]):e._e(),e._v(" "),e.draw.remainder?r("p",[r("b",[e._v("Остаток:")]),e._v(" "+e._s(e.draw.remainder))]):e._e(),e._v(" "),e.draw.date?r("p",[r("b",[e._v("Дата:")]),e._v(" "+e._s(e.draw.date))]):e._e(),e._v(" "),e.draw.person?r("p",[r("b",[e._v("Донор:")]),e._v(" "),r("b-link",{attrs:{href:"#",to:{name:"PersonShow",params:{id:e.draw.person._id}}}},[e._v(e._s(e.draw.person.firstName)+" "+e._s(e.draw.person.lastName))])],1):e._e(),e._v(" "),e.draw.description?r("p",[r("b",[e._v("Доп.информация:")]),e._v(" "+e._s(e.draw.description))]):e._e(),e._v(" "),r("b-button",{attrs:{to:{name:"TransAdd",params:{id:e.draw._id}},variant:"primary"}},[e._v("Сделать переливание")]),e._v(" "),r("b-button",{attrs:{to:{name:"Draws"},variant:"primary"}},[e._v("Список заборов")])],1)])])],1)},staticRenderFns:[]};var Z=r("VU/8")(X,K,!1,function(e){r("XVs9")},null,null).exports,q=function(e){return w().get("api/trans",{params:e})},Y=function(e){return w().post("api/trans",e)},ee=function(e){return w().get("api/trans/"+e.id)},te={name:"DrawAdd",data:function(){return{volume:null,description:"",date:this.$tools.formatDate(new Date),time:this.$tools.formatTime(new Date),recipient:{},draw:{},errors:[]}},components:{"person-window":P,"draw-window":L},methods:{addTrans:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.volume&&e.draw.source._id&&e.draw.bloodType._id&&e.recipient._id&&e.draw._id&&e.date&&e.time){t.next=2;break}return t.abrupt("return",e.errors.push({message:"Заполните правильно все обязательные поля"}));case 2:return t.prev=2,t.next=5,Y({volume:e.volume,source:e.draw.source._id,bloodType:e.draw.bloodType._id,recipient:e.recipient._id,draw:e.draw._id,date:e.date+" "+e.time,description:e.description});case 5:void 0===(r=t.sent).data.success||r.data.success?e.$router.push({name:"TransShow",params:{id:r.data.data._id}}):r.data.errors&&r.data.errors.forEach(function(t,r,a){e.errors.push(t)}),t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(2),t.t0.response){t.next=13;break}return t.abrupt("return",e.errors.push({message:"Отсутствует соединение с сервером"}));case 13:e.errors.push({message:t.t0.response.data.errors});case 14:case"end":return t.stop()}},t,e,[[2,9]])}))()},getDraw:function(e){var t=this;return b()(m.a.mark(function r(){var a;return m.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,V({id:e});case 2:!1!==(a=r.sent).data.success&&(t.draw=a.data.data);case 4:case"end":return r.stop()}},r,t)}))()},setRecipient:function(e){this.recipient=e,this.$refs.recModal.hide()},setDraw:function(e){this.draw=e,this.$refs.drawModal.hide()},clearErrors:function(){this.errors=[]}},created:function(){this.$route.params.id&&this.getDraw(this.$route.params.id)}},re={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("h1",[e._v("Сделать переливание")]),e._v(" "),r("error-board",{attrs:{errors:e.errors},on:{clearerrors:e.clearErrors}}),e._v(" "),r("b-row",[r("b-col",{attrs:{sm:"6"}},[r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("div",{staticClass:"card"},[r("h5",{staticClass:"card-header"},[r("b",[e._v("Забор: ")]),e.draw.bloodType?r("span",[e._v(e._s(e.draw.bloodType.typeName))]):e._e()]),e._v(" "),r("div",{staticClass:"card-body"},[e.draw.source?r("p",[r("b",[e._v("Материал:")]),e._v(" "+e._s(e.draw.source.sourceName))]):e._e(),e._v(" "),e.draw.volume&&e.draw.source?r("p",[r("b",[e._v("Исходное количество: ")]),e._v(e._s(e.draw.volume)+" "+e._s(e.draw.source.measure))]):e._e(),e._v(" "),e.draw.remainder&&e.draw.source?r("p",[r("b",[e._v("Объем остатка: ")]),e._v(e._s(e.draw.remainder)+" "+e._s(e.draw.source.measure))]):e._e(),e._v(" "),e.draw.person?r("p",[r("b",[e._v("Донор: ")]),e._v(e._s(e.draw.person.firstName)+" "+e._s(e.draw.person.lastName))]):e._e(),e._v(" "),r("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.drawModal",modifiers:{drawModal:!0}}]},[e._v("Выбрать забор")]),e._v(" "),r("b-modal",{ref:"drawModal",attrs:{id:"drawModal",size:"lg",title:"Выбор забор","ok-only":"","ok-title":"Отменить"}},[r("draw-window",{attrs:{mode:"drawselect"},on:{selectdraw:e.setDraw}})],1)],1)])]),e._v(" "),r("div",[e._v("-")]),e._v(" "),r("b-col",{attrs:{sm:"12"}},[r("div",{staticClass:"card"},[r("h5",{staticClass:"card-header"},[r("b",[e._v("Реципиент: ")]),e.recipient.fullName?r("span",[e._v(e._s(e.recipient.fullName))]):e._e()]),e._v(" "),r("div",{staticClass:"card-body"},[e.recipient.bloodType?r("p",[r("b",[e._v("Группа крови: ")]),e._v(e._s(e.recipient.bloodType.typeName))]):e._e(),e._v(" "),r("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.recModal",modifiers:{recModal:!0}}]},[e._v("Выбрать реципиента")]),e._v(" "),r("b-modal",{ref:"recModal",attrs:{id:"recModal",title:"Выбор реципиента","ok-only":"","ok-title":"Отменить"}},[r("person-window",{attrs:{mode:"personselect"},on:{selectperson:e.setRecipient}})],1)],1)])])],1)],1),e._v(" "),r("b-col",{attrs:{cols:"6"}},[r("b-form",{attrs:{method:"POST"},on:{submit:function(t){t.preventDefault(),e.addTrans(t)}}},[r("b-form-group",{attrs:{horizontal:"",label:"Количество","label-cols":3,breakpoints:"md","label-for":"volume"}},[r("b-form-input",{staticClass:"form-control",attrs:{type:"text",id:"volume",name:"volume"},model:{value:e.volume,callback:function(t){e.volume=t},expression:"volume"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Дата","label-cols":3,breakpoints:"md","label-for":"date"}},[r("b-form-input",{staticClass:"form-control",attrs:{type:"text",id:"date",name:"date"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Время","label-cols":3,breakpoints:"md","label-for":"time"}},[r("b-form-input",{staticClass:"form-control",attrs:{type:"text",id:"time",name:"date"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1),e._v(" "),r("b-form-group",{attrs:{horizontal:"",label:"Доп. информация","label-cols":3,breakpoints:"md","label-for":"description"}},[r("b-form-textarea",{staticClass:"form-control",attrs:{id:"description",name:"description",rows:"6"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1),e._v(" "),r("b-col",{attrs:{cols:"6"}},[r("b-btn",{attrs:{type:"submit",variant:"primary"}},[e._v("Произвести переливание")])],1)],1)],1)],1)],1)},staticRenderFns:[]},ae=r("VU/8")(te,re,!1,null,null,null).exports,se={name:"Persons",data:function(){return{fields:[{key:"index",label:"#"},{key:"date",label:"Дата"},{key:"recipient",label:"Реципиент"},{key:"source",label:"Материал"},{key:"volume",label:"Объем"},{key:"bloodType",label:"Группа крови"},{key:"draw",label:"Дата забора"},{key:"actions",label:"Action"}],trans:[],bloodTypes:[]}},methods:{getTrans:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q();case 2:r=t.sent,e.trans=r.data.data.map(function(t){return t.recipient.fullName=e.$tools.smartJoin([t.recipient.firstName,t.recipient.lastName,t.recipient.middleName]),t});case 4:case"end":return t.stop()}},t,e)}))()},getBloodTypes:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:r=t.sent,e.bloodTypes=r.data.data;case 4:case"end":return t.stop()}},t,e)}))()}},created:function(){this.getTrans(),this.getBloodTypes()}},oe={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("h1",[e._v("Переливания крови")]),e._v(" "),r("b-table",{attrs:{striped:"",small:"",hover:"",items:e.trans,fields:e.fields},scopedSlots:e._u([{key:"index",fn:function(t){return[e._v("\n        "+e._s(t.index+1)+"\n      ")]}},{key:"source",fn:function(t){return[e._v("\n        "+e._s(t.value.sourceName)+" ("+e._s(t.value.measure)+")\n      ")]}},{key:"recipient",fn:function(t){return[e._v("\n        "+e._s(t.value.fullName)+" "),r("br"),e._v(e._s(t.value.bloodType.typeName)+"\n      ")]}},{key:"bloodType",fn:function(t){return[e._v("\n        "+e._s(t.value.typeName)+" ("+e._s(t.value._id)+")\n      ")]}},{key:"draw",fn:function(t){return[e._v("\n        "+e._s(t.value.date)+" "),r("br"),e._v(e._s(t.value.person.firstName)+" "+e._s(t.value.person.lastName)+"\n      ")]}},{key:"actions",fn:function(t){return[r("b-btn",{attrs:{size:"sm",to:{name:"TransShow",params:{id:t.item._id}}}},[e._v("\n          просмотреть\n        ")])]}}])})],1)],1)},staticRenderFns:[]},ne=r("VU/8")(se,oe,!1,null,null,null).exports,ie={name:"TransShow",data:function(){return{trans:{}}},methods:{getTrans:function(){var e=this;return b()(m.a.mark(function t(){var r;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ee({id:e.$route.params.id});case 2:!1!==(r=t.sent).data.success&&(e.trans=r.data.data);case 4:case"end":return t.stop()}},t,e)}))()}},created:function(){},mounted:function(){this.getTrans()}},le={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-row",[r("b-container",[r("h1",[e._v("Информация о переливании")])]),e._v(" "),r("b-col",{attrs:{cols:"12"}},[r("div",{staticClass:"card"},[r("h5",{staticClass:"card-header"},[r("b",[e._v("Группа крови: ")]),e.trans.bloodType?r("span",[e._v(e._s(e.trans.bloodType.typeName))]):e._e()]),e._v(" "),r("div",{staticClass:"card-body"},[e.trans.source?r("p",[r("b",[e._v("Материал:")]),e._v(" "+e._s(e.trans.source.sourceName)+" ("+e._s(e.trans.source.measure)+")")]):e._e(),e._v(" "),e.trans.volume?r("p",[r("b",[e._v("Объем:")]),e._v(" "+e._s(e.trans.volume))]):e._e(),e._v(" "),e.trans.date?r("p",[r("b",[e._v("Дата переливания:")]),e._v(" "+e._s(e.trans.date))]):e._e(),e._v(" "),e.trans.draw?r("p",[r("b",[e._v("Дата забора:")]),e._v(" "),r("b-link",{attrs:{href:"#",to:{name:"DrawShow",params:{id:e.trans.draw._id}}}},[e._v(e._s(e.trans.draw.date))])],1):e._e(),e._v(" "),e.trans.recipient?r("p",[r("b",[e._v("Реципиент:")]),e._v(" "),r("b-link",{attrs:{href:"#",to:{name:"PersonShow",params:{id:e.trans.recipient._id}}}},[e._v(e._s(e.trans.recipient.firstName)+" "+e._s(e.trans.recipient.lastName))])],1):e._e(),e._v(" "),e.trans.draw?r("p",[r("b",[e._v("Донор:")]),e._v(" "),r("b-link",{attrs:{href:"#",to:{name:"PersonShow",params:{id:e.trans.draw.person._id}}}},[e._v(e._s(e.trans.draw.person.firstName)+" "+e._s(e.trans.draw.person.lastName))])],1):e._e(),e._v(" "),e.trans.description?r("p",[r("b",[e._v("Доп.информация:")]),e._v(" "+e._s(e.trans.description))]):e._e(),e._v(" "),r("b-button",{attrs:{to:{name:"TransAdd",params:{id:e.trans._id}},variant:"primary"}},[e._v("Сделать новое переливание")]),e._v(" "),r("b-button",{attrs:{to:{name:"Trans"},variant:"primary"}},[e._v("Список переливаний")])],1)])])],1)},staticRenderFns:[]};var ce=r("VU/8")(ie,le,!1,function(e){r("zmQJ")},null,null).exports;a.a.use(l.a);var de=new l.a({mode:"history",routes:[{path:"/",name:"HelloWorld",component:d},{path:"/person",name:"Persons",component:P},{path:"/person/show/:id",name:"PersonShow",component:E},{path:"/person/add",name:"PersonAdd",component:F},{path:"/person/edit",name:"PersonEdit",component:R},{path:"/draw",name:"Draws",component:L},{path:"/draw/show/:id",name:"DrawShow",component:Z},{path:"/draw/add",name:"DrawAdd",component:Q},{path:"/trans",name:"Trans",component:ne},{path:"/trans/show/:id",name:"TransShow",component:ce},{path:"/trans/add",name:"TransAdd",component:ae}]}),pe={smartJoin:function(e,t){return t||(t=" "),e.filter(function(e){return void 0!==e&&null!==e&&""!==e.toString().trim()}).join(t)},formatDate:function(e){var t=e.getDate();t<10&&(t="0"+t);var r=e.getMonth()+1;return r<10&&(r="0"+r),t+"."+r+"."+e.getFullYear()},formatTime:function(e){var t=e.getHours();t<10&&(t="0"+t);var r=e.getMinutes();return r<10&&(r="0"+r),t+":"+r}};a.a.config.productionTip=!1,a.a.use(s.a),a.a.prototype.$tools=pe,a.a.component("error-board",D),new a.a({el:"#app",router:de,components:{App:i},template:"<App/>"})},XVs9:function(e,t){},wGKJ:function(e,t){},yiZ2:function(e,t){},zj2Q:function(e,t){},zmQJ:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.80c873c7d39805ec3290.js.map